// Language Switcher for Dashavatar Project

// Store all translatable content
const translations = {
    'en': {
        // Navigation
        'nav_home': 'Home',
        'nav_avatars': 'Avatars',
        'nav_timeline': 'Timeline',
        'nav_quiz': 'Quiz',
        'nav_resources': 'Resources',
        'nav_compare': 'Compare',
        
        // Avatar details
        'avatar_story_title': 'Story',
        'avatar_evolution_title': 'Evolution & Significance',
        'avatar_symbols_title': 'Symbols & Representations',
        'avatar_more_info': 'More Information',
        'avatar_flip': 'Flip Card',
        'avatar_back': 'Back',
        
        // Avatars specific content
        'matsya': {
            'title': 'Matsya Avatar',
            'sanskrit': 'मत्स्य अवतार',
            'era': 'Satya Yuga',
            'story': 'Matsya (Fish) was the first avatar of Lord Vishnu. When the demon Hayagriva stole the Vedas from Lord Brahma and hid them in the depths of the cosmic ocean, Lord Vishnu took the form of a fish to recover them. During this time, he also saved Manu (the progenitor of mankind) from a great deluge, instructing him to build a boat and collect all species of plants and animals.',
            'evolution': 'The Matsya avatar represents the beginning of life in water, symbolizing the evolutionary process from aquatic life forms. This avatar saved the Vedas, preserving knowledge and wisdom for future generations. The story of Matsya saving Manu from the great flood has parallels in many world cultures, including the Biblical story of Noah\'s Ark.',
            'symbols': 'Matsya is typically depicted as half-man and half-fish, holding a conch shell (shankha), a discus (chakra), a lotus (padma), and a mace (gada) - the four symbols of Vishnu.'
        },
        'kurma': {
            'title': 'Kurma Avatar',
            'sanskrit': 'कूर्म अवतार',
            'era': 'Satya Yuga',
            'story': 'Kurma (Turtle) was the second avatar of Lord Vishnu. The devas (gods) and asuras (demons) were churning the cosmic ocean to obtain amrita (the nectar of immortality). They used Mount Mandara as the churning rod and the serpent Vasuki as the rope. However, the mountain began to sink. Lord Vishnu took the form of a giant turtle, dove to the bottom of the ocean, and supported the mountain on his back, allowing the churning to continue.',
            'evolution': 'The Kurma avatar represents the transition of life from water to amphibious existence, symbolizing evolution from purely aquatic creatures to those that could survive on both land and water. This avatar is associated with stability and support, providing the foundation for cosmic creation.',
            'symbols': 'Kurma is depicted as a turtle or as a human torso on a turtle base. The churning of the ocean (Samudra Manthan) produced many divine treasures including the goddess Lakshmi, the divine physician Dhanvantari with amrita, and the deadly poison Halahala which Shiva consumed.'
        },
        // Add more avatars here
    },
    'hi': {
        // Navigation
        'nav_home': 'मुख्य पृष्ठ',
        'nav_avatars': 'अवतार',
        'nav_timeline': 'समयरेखा',
        'nav_quiz': 'प्रश्नोत्तरी',
        'nav_resources': 'संसाधन',
        'nav_compare': 'तुलना करें',
        
        // Avatar details
        'avatar_story_title': 'कथा',
        'avatar_evolution_title': 'विकास और महत्व',
        'avatar_symbols_title': 'प्रतीक और निरूपण',
        'avatar_more_info': 'अधिक जानकारी',
        'avatar_flip': 'कार्ड पलटें',
        'avatar_back': 'वापस',
        
        // Avatars specific content
        'matsya': {
            'title': 'मत्स्य अवतार',
            'sanskrit': 'मत्स्य अवतार',
            'era': 'सत्य युग',
            'story': 'मत्स्य (मछली) भगवान विष्णु का पहला अवतार था। जब हयग्रीव राक्षस ने भगवान ब्रह्मा से वेदों को चुरा लिया और उन्हें ब्रह्मांडीय समुद्र की गहराई में छिपा दिया, तब भगवान विष्णु ने उन्हें पुनः प्राप्त करने के लिए एक मछली का रूप धारण किया। इस दौरान, उन्होंने मनु (मानव जाति के जनक) को एक महाप्रलय से भी बचाया, उन्हें एक नाव बनाने और पौधों और जानवरों की सभी प्रजातियों को इकट्ठा करने का निर्देश दिया।',
            'evolution': 'मत्स्य अवतार पानी में जीवन की शुरुआत का प्रतिनिधित्व करता है, जो जलीय जीवन रूपों से विकासवादी प्रक्रिया का प्रतीक है। इस अवतार ने वेदों को बचाया, भविष्य की पीढ़ियों के लिए ज्ञान और बुद्धि को संरक्षित किया। मत्स्य द्वारा मनु को महाप्रलय से बचाने की कहानी की कई विश्व संस्कृतियों में समानताएं हैं, जिसमें बाइबिल की नूह के आर्क की कहानी भी शामिल है।',
            'symbols': 'मत्स्य को आमतौर पर आधा-मनुष्य और आधा-मछली के रूप में दर्शाया जाता है, जो शंख, चक्र, पद्म और गदा - विष्णु के चार प्रतीकों को धारण करते हैं।'
        },
        'kurma': {
            'title': 'कूर्म अवतार',
            'sanskrit': 'कूर्म अवतार',
            'era': 'सत्य युग',
            'story': 'कूर्म (कछुआ) भगवान विष्णु का दूसरा अवतार था। देवता और असुर अमृत (अमरता का अमृत) प्राप्त करने के लिए ब्रह्मांडीय समुद्र का मंथन कर रहे थे। उन्होंने मंदार पर्वत को मंथन छड़ के रूप में और वासुकि सर्प को रस्सी के रूप में उपयोग किया। हालांकि, पर्वत डूबने लगा। भगवान विष्णु ने एक विशाल कछुए का रूप धारण किया, समुद्र के तल तक गए, और अपनी पीठ पर पर्वत को सहारा दिया, जिससे मंथन जारी रह सका।',
            'evolution': 'कूर्म अवतार पानी से उभयचर अस्तित्व तक जीवन के संक्रमण का प्रतिनिधित्व करता है, जो विशुद्ध रूप से जलीय जीवों से उन जीवों तक के विकास का प्रतीक है जो जमीन और पानी दोनों पर जीवित रह सकते हैं। यह अवतार स्थिरता और समर्थन से जुड़ा है, जो ब्रह्मांडीय सृष्टि के लिए आधार प्रदान करता है।',
            'symbols': 'कूर्म को एक कछुए के रूप में या एक कछुए के आधार पर मानव धड़ के रूप में दर्शाया गया है। समुद्र मंथन (समुद्र मंथन) से कई दिव्य खजाने निकले, जिनमें देवी लक्ष्मी, अमृत के साथ दिव्य चिकित्सक धन्वंतरि, और घातक विष हलाहल शामिल हैं, जिसे शिव ने ग्रहण किया था।'
        },
        // Add more avatars here
    },
    'sa': {
        // Add Sanskrit translations
        'nav_home': 'गृहम्',
        'nav_avatars': 'अवतारः',
        'nav_timeline': 'कालरेखा',
        'nav_quiz': 'प्रश्नोत्तरी',
        'nav_resources': 'संसाधनानि',
        'nav_compare': 'तुलना',
        
        // Avatar details
        'avatar_story_title': 'कथा',
        'avatar_evolution_title': 'विकासः महत्त्वं च',
        'avatar_symbols_title': 'प्रतीकानि निरूपणानि च',
        'avatar_more_info': 'अधिकजानकारी',
        'avatar_flip': 'पत्रं परिवर्तयतु',
        'avatar_back': 'पुनरागमनम्',
        
        // Add Sanskrit translations for avatars
    }
};

// Function to update all translatable content on the page
function updatePageLanguage(lang) {
    console.log("Updating language to: " + lang);
    
    // Default to English if the selected language is not available
    if (!translations[lang]) {
        console.log("Language not found, defaulting to English");
        lang = 'en';
    }
    
    // Update navigation items
    document.querySelectorAll('[data-lang-key]').forEach(element => {
        const key = element.getAttribute('data-lang-key');
        if (translations[lang][key]) {
            element.textContent = translations[lang][key];
            console.log("Updated element with key: " + key);
        }
    });
    
    // Update avatar details if we're on an avatar page
    const avatarElements = document.querySelectorAll('[data-avatar]');
    
    avatarElements.forEach(avatarElement => {
        const currentAvatar = avatarElement.getAttribute('data-avatar');
        console.log("Found avatar: " + currentAvatar);
        
        if (currentAvatar && translations[lang][currentAvatar]) {
            // Update title
            const titleElement = avatarElement.querySelector('h2');
            if (titleElement) {
                titleElement.innerHTML = translations[lang][currentAvatar].title + 
                    ' <span class="sanskrit">' + translations[lang][currentAvatar].sanskrit + '</span>';
                console.log("Updated title for: " + currentAvatar);
            }
            
            // Update era
            const eraElement = avatarElement.querySelector('.era');
            if (eraElement) {
                eraElement.textContent = translations[lang][currentAvatar].era;
                console.log("Updated era for: " + currentAvatar);
            }
            
            // Update story
            const storyElement = avatarElement.querySelector('.avatar-story p');
            if (storyElement) {
                storyElement.textContent = translations[lang][currentAvatar].story;
                console.log("Updated story for: " + currentAvatar);
            }
            
            // Update evolution
            const evolutionElement = avatarElement.querySelector('.avatar-evolution p');
            if (evolutionElement) {
                evolutionElement.textContent = translations[lang][currentAvatar].evolution;
                console.log("Updated evolution for: " + currentAvatar);
            }
            
            // Update symbols if present
            const symbolsElement = avatarElement.querySelector('.avatar-symbols p');
            if (symbolsElement && translations[lang][currentAvatar].symbols) {
                symbolsElement.textContent = translations[lang][currentAvatar].symbols;
                console.log("Updated symbols for: " + currentAvatar);
            }
        }
    });
    
    // Update section titles
    document.querySelectorAll('.avatar-story h3').forEach(el => {
        el.textContent = translations[lang].avatar_story_title;
    });
    
    document.querySelectorAll('.avatar-evolution h3').forEach(el => {
        el.textContent = translations[lang].avatar_evolution_title;
    });
    
    document.querySelectorAll('.avatar-symbols h3').forEach(el => {
        el.textContent = translations[lang].avatar_symbols_title;
    });
    
    // Update buttons
    document.querySelectorAll('.flip-btn').forEach(btn => {
        if (!btn.closest('.avatar-card-back')) {
            btn.textContent = translations[lang].avatar_flip;
        } else {
            btn.textContent = translations[lang].avatar_back;
        }
    });
}

// Initialize language switcher
document.addEventListener('DOMContentLoaded', function() {
    console.log("DOM loaded, initializing language switcher");
    const langSelect = document.getElementById('lang-select');
    
    if (langSelect) {
        console.log("Language selector found");
        
        // Check for stored language preference
        const storedLang = localStorage.getItem('preferredLanguage');
        if (storedLang) {
            console.log("Found stored language: " + storedLang);
            langSelect.value = storedLang;
        }
        
        // Set initial language based on select value
        updatePageLanguage(langSelect.value);
        
        // Add event listener for language change
        langSelect.addEventListener('change', function() {
            console.log("Language changed to: " + this.value);
            updatePageLanguage(this.value);
            
            // Store language preference in localStorage
            localStorage.setItem('preferredLanguage', this.value);
        });
    } else {
        console.log("Language selector not found");
    }
});